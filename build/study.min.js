/**
 * studyjs - A client side A/B tester
 * @version v1.1.2
 * @link https://github.com/dollarshaveclub/study
 * @author Jacob Kelley <jacob.kelley@dollarshaveclub.com>
 * @license MIT */
(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Study=t()})(this,function(){"use strict";function e(e){function t(e,t,n){var r=void 0,o=void 0;n?(r=new Date,r.setTime(r.getTime()+1e3*60*60*24*n),o="; expires="+r.toGMTString()):o="",document.cookie=e+"="+(t+o)+"; path=/"}function n(e){var t,n,r=e+"=",o=document.cookie.split(";");for(t=0;o.length>t;t++){for(n=o[t];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(r))return n.substring(r.length,n.length)}return null}function r(n){n=JSON.stringify(n),"session"==e?window.name=n:t("localStorage",n,365)}function o(){"session"==e?window.name="":t("localStorage","",365)}function i(){var t="session"==e?window.name:n("localStorage");return t?JSON.parse(t):{}}var a=i();return{length:0,clear:function(){a={},this.length=0,o()},getItem:function(e){return void 0===a[e]?null:a[e]},key:function(e){var t=0;for(var n in a){if(t==e)return n;t++}return null},removeItem:function(e){delete a[e],this.length--,r(a)},setItem:function(e,t){a[e]=t+"",this.length++,r(a)}}}function t(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}var n=function(e){if(!e)return!1;try{return e.setItem("a","a"),!0}catch(t){return!1}}(window.localStorage),r={local:n?window.localStorage:new e("local"),session:n?window.sessionStorage:new e("session")};(function(){function e(e){this.value=e}function t(t){function n(e,t){return new Promise(function(n,o){var u={key:e,arg:t,resolve:n,reject:o,next:null};a?a=a.next=u:(i=a=u,r(e,t))})}function r(n,i){try{var a=t[n](i),u=a.value;u instanceof e?Promise.resolve(u.value).then(function(e){r("next",e)},function(e){r("throw",e)}):o(a.done?"return":"normal",a.value)}catch(c){o("throw",c)}}function o(e,t){switch(e){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}i=i.next,i?r(i.key,i.arg):a=null}var i,a;this._invoke=n,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}})();var o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u="classList"in document.createElement("_"),c="ab-tests",s=function(){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(o(this,e),s={persist:s.persist!==void 0?s.persist:!0,active:s.active!==void 0?s.active:!0,chosen:s.chosen!==void 0?s.chosen:!1},!n)throw Error("Tests must have a name");if(!s.active)return{active:!1};var l=r.local.getItem(c);if(l)try{l=JSON.parse(l)}catch(f){l={}}else l={};var h=void 0,v=(t("assign")||"").split(":"),d=a(v,2),g=d[0],y=d[1],m=g===n,p=y in i,w=s.persist&&l[n],b=m&&p||!w;if(b){for(var k=Object.keys(i),S=[],x=0;k.length>x;x++)i[k[x]].weight===void 0&&(i[k[x]].weight=1),S.push(i[k[x]].weight);h=m&&p?y:e.chooseWeightedItem(k,S),l[n]={bucket:h,buckets:Object.keys(i)},r.local.setItem(c,JSON.stringify(l))}else h=l[n].bucket;var I=n+"--"+h;u?document.body.classList.add(I):document.body.className+=" "+I;var O={bucket:h,data:i[h],active:!0};if(i[h]&&(i[h].chosen||(i[h].chosen=e.noop),i[h].chosen.call(this)),s.chosen&&s.chosen.call(this,O),"undefined"!=typeof dataLayer){var T={abTests:{}};T.abTests[n]=h,dataLayer.push(T)}return O}return i(e,null,[{key:"chooseWeightedItem",value:function(t,n){var r,o=0;for(r=0;n.length>r;r++)o+=n[r];var i=0,a=e.rand(0,o);for(r=0;t.length>r;r++)if(i+=n[r],i>=a)return t[r]}},{key:"noop",value:function(){}},{key:"rand",value:function(e,t){return Math.random()*(t-e)+e}}]),e}();return s})
